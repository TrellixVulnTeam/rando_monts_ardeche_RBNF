"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4728],{1158:(N,k,p)=>{p.d(k,{b:()=>q});var T=p(655),i=p(1135),C=p(9841),m=p(5857),e=p(7587),l=p(786),v=p(8413),S=p(5407),F=p(8317),g=p(9808),y=p(5722),Z=p(7489);function b(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"ion-img",3),e.NdJ("ionError",function(){return e.CHM(t),e.oxw().onImgPracticeSrcError()}),e.qZA()}if(2&r){const t=e.oxw();e.Udp("background-color",t.value.color?t.value.color:"transparent"),e.Q6J("src",t.imgPracticeSrc)}}let a=(()=>{class r{constructor(t){this.offlineTreks=t,this.valueChange=new e.vpe,this.firstTryToLoadFromOnline=!0,this.hideImgPracticeSrc=!1}ngOnInit(){return(0,T.mG)(this,void 0,void 0,function*(){this.imgPracticeSrc=yield this.offlineTreks.getTrekImageSrc({},{url:this.value.pictogram})})}valueCheckChanged(t,n){this.valueChange.emit({checked:t.detail.checked,value:n})}onImgPracticeSrcError(){this.value.pictogram&&this.firstTryToLoadFromOnline?(this.firstTryToLoadFromOnline=!1,this.imgPracticeSrc=this.commonSrc+this.value.pictogram):this.hideImgPracticeSrc=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(F.U))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-filter-value"]],inputs:{value:"value",commonSrc:"commonSrc"},outputs:{valueChange:"valueChange"},decls:5,vars:3,consts:[[1,"no-lines"],["style","width: 24px; height: 24px; margin-right: 12px",3,"background-color","src","ionError",4,"ngIf"],["slot","start",3,"checked","ionChange"],[2,"width","24px","height","24px","margin-right","12px",3,"src","ionError"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-item",0),e.YNc(1,b,1,3,"ion-img",1),e.TgZ(2,"ion-label"),e._uU(3),e.qZA(),e.TgZ(4,"ion-checkbox",2),e.NdJ("ionChange",function(h){return n.valueCheckChanged(h,n.value)}),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.value.pictogram&&!n.hideImgPracticeSrc),e.xp6(2),e.Oqu(n.value.name),e.xp6(1),e.Q6J("checked",n.value.checked))},directives:[l.Ie,g.O5,l.Xz,l.Q$,l.nz,l.w],styles:[".no-lines[_ngcontent-%COMP%]{--inner-border-width: 0px}"]}),r})();var _=p(7232);function s(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"ion-toolbar",0)(1,"ion-searchbar",6),e.NdJ("ionChange",function(o){return e.CHM(t),e.oxw().search(o)}),e.ALo(2,"translate"),e.qZA()()}2&r&&(e.xp6(1),e.s9C("placeholder",e.lcZ(2,1,"filters.searchPlaceholder")))}function u(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"app-filter-value",7),e.NdJ("valueChange",function(o){return e.CHM(t),e.oxw().valueChanged(o)}),e.qZA()}if(2&r){const t=c.$implicit,n=e.oxw();e.Q6J("commonSrc",n.commonSrc)("value",t)}}let f=(()=>{class r{constructor(t){this.modalController=t,this.currentMaxFilterValues=20,this.filterValuesByStep=20}ngOnInit(){this.temporaryFilter=this.filter,this.valuesToDisplay=[...this.filter.values]}cancel(){this.modalController.dismiss()}select(){this.modalController.dismiss({temporaryFilter:this.temporaryFilter})}expandFilterValues(t){this.currentMaxFilterValues<this.valuesToDisplay.length&&(this.currentMaxFilterValues+this.filterValuesByStep>this.valuesToDisplay.length?this.currentMaxFilterValues=this.valuesToDisplay.length:this.currentMaxFilterValues+=this.filterValuesByStep),t.target.complete()}trackFilterValues(t,n){return n?n.id:null}valueChanged(t){const n=this.temporaryFilter.values.find(o=>o.id===t.value.id);n&&(n.checked=t.checked)}search(t){this.valuesToDisplay=t.detail.value?this.searchValuesInFilter(this.filter,t.detail.value):[...this.filter.values],this.currentMaxFilterValues=this.filterValuesByStep}searchValuesInFilter(t,n){return t?n?(n=n.toLowerCase(),t.values.filter(o=>(0,Z.deburr)(o.name.toLowerCase()).startsWith(n)).sort(function(o,h){return o.name.localeCompare(h.name)})):t.values.sort(function(o,h){return o.name.localeCompare(h.name)}):[]}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(l.IN))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-select-filter"]],inputs:{filter:"filter",commonSrc:"commonSrc"},decls:19,vars:14,consts:[["color","primary"],["color","primary",4,"ngIf"],[3,"commonSrc","value","valueChange",4,"ngFor","ngForOf","ngForTrackBy"],["threshold","100px",3,"ionInfinite"],["slot","end"],["color","primary","fill","clear",3,"click"],[3,"placeholder","ionChange"],[3,"commonSrc","value","valueChange"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e._uU(3),e.qZA()(),e.YNc(4,s,3,3,"ion-toolbar",1),e.qZA(),e.TgZ(5,"ion-content"),e.YNc(6,u,1,2,"app-filter-value",2),e.ALo(7,"slice"),e.TgZ(8,"ion-infinite-scroll",3),e.NdJ("ionInfinite",function(h){return n.expandFilterValues(h)}),e._UZ(9,"ion-infinite-scroll-content"),e.qZA()(),e.TgZ(10,"ion-footer")(11,"ion-toolbar")(12,"ion-buttons",4)(13,"ion-button",5),e.NdJ("click",function(){return n.cancel()}),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"ion-button",5),e.NdJ("click",function(){return n.select()}),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()),2&t&&(e.xp6(3),e.Oqu(n.filter.values.length+" "+n.filter.name),e.xp6(1),e.Q6J("ngIf",n.filter.values.length>n.filterValuesByStep),e.xp6(2),e.Q6J("ngForOf",e.Dn7(7,6,n.valuesToDisplay,0,n.currentMaxFilterValues))("ngForTrackBy",n.trackFilterValues),e.xp6(8),e.hij(" ",e.lcZ(15,10,"filters.cancelButton")," "),e.xp6(3),e.hij(" ",e.lcZ(18,12,"filters.confirmButton")," "))},directives:[l.Gu,l.sr,l.wd,g.O5,l.VI,l.j9,l.W2,g.sg,a,l.ju,l.MB,l.fr,l.Sm,l.YG],pipes:[_.X$,g.OU],styles:[""]}),r})();function d(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"app-filter-value",3),e.NdJ("valueChange",function(o){return e.CHM(t),e.oxw(2).valueChanged(o)}),e.qZA()}if(2&r){const t=c.$implicit,n=e.oxw(2);e.Q6J("commonSrc",n.commonSrc)("value",t)}}function x(r,c){if(1&r&&(e.ynx(0),e.YNc(1,d,1,2,"app-filter-value",2),e.BQk()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.filter.values)}}function J(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"ion-item",4),e.NdJ("click",function(){return e.CHM(t),e.oxw().openSelect()}),e.TgZ(1,"ion-label",5),e._uU(2),e.ALo(3,"translate"),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(2),e.hij(" ",""===t.selectedItems?e.lcZ(3,1,"filters.selectPlaceholder")+" "+t.filter.name.toLowerCase():t.selectedItems," ")}}let w=(()=>{class r{constructor(t){this.modalController=t,this.valueChange=new e.vpe,this.selectChange=new e.vpe,this.selectedItems="",this.containsFilterShouldUseSelectAbove=y.N.containsFilterShouldUseSelectAbove}ngOnInit(){this.updateSelectedItems(this.filter)}ngDoCheck(){this.filter.values.find(t=>t.checked)||this.updateSelectedItems(this.filter)}valueChanged({checked:t,value:n}){this.valueChange.emit({checked:t,value:n})}openSelect(){return(0,T.mG)(this,void 0,void 0,function*(){const t=yield this.modalController.create({component:f,componentProps:{filter:this.filter,commonSrc:this.commonSrc},cssClass:"full-size"});yield t.present();const{data:n}=yield t.onDidDismiss();n&&n.temporaryFilter&&(this.updateSelectedItems(n.temporaryFilter),this.selectChange.emit({filter:n.temporaryFilter}))})}updateSelectedItems(t){const n=[];for(const o of t.values)o.checked&&n.push(o.name);this.selectedItems=n.join(", ")}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(l.IN))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-filter"]],inputs:{filter:"filter",commonSrc:"commonSrc"},outputs:{valueChange:"valueChange",selectChange:"selectChange"},decls:7,vars:3,consts:[[4,"ngIf","ngIfElse"],["select",""],[3,"commonSrc","value","valueChange",4,"ngFor","ngForOf"],[3,"commonSrc","value","valueChange"],["detail","","button","","detailIcon","chevron-down-outline",3,"click"],[1,"select-placeholder"]],template:function(t,n){if(1&t&&(e.TgZ(0,"ion-label")(1,"ion-text")(2,"h1"),e._uU(3),e.qZA()()(),e.YNc(4,x,2,1,"ng-container",0),e.YNc(5,J,4,3,"ng-template",null,1,e.W1O)),2&t){const o=e.MAs(6);e.xp6(3),e.Oqu(n.filter.name),e.xp6(1),e.Q6J("ngIf",n.filter.values.length<=n.containsFilterShouldUseSelectAbove)("ngIfElse",o)}},directives:[l.Q$,l.yW,g.O5,g.sg,a,l.Ie],pipes:[_.X$],styles:[".select-placeholder[_ngcontent-%COMP%]{color:var(--ion-color-medium)}"]}),r})();function Y(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"ion-item",10)(1,"app-filter",11),e.NdJ("valueChange",function(o){const A=e.CHM(t).$implicit;return e.oxw(2).handleFiltersState(o.checked,A,o.value)})("selectChange",function(o){return e.CHM(t),e.oxw(2).handleSelect(o)}),e.qZA()()}if(2&r){const t=c.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("commonSrc",n.commonSrc)("filter",t)}}function M(r,c){if(1&r&&(e.ynx(0,null,7),e.TgZ(2,"ion-list",8),e.YNc(3,Y,2,2,"ion-item",9),e.ALo(4,"async"),e.qZA(),e.BQk()),2&r){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",e.lcZ(4,1,t.temporaryFilters$))}}function V(r,c){1&r&&(e.TgZ(0,"span",16),e._uU(1,"filters.zeroresult"),e.qZA())}function U(r,c){1&r&&(e.TgZ(0,"span",17),e._uU(1,"filters.oneresult"),e.qZA())}const $=function(r){return{nb:r}};function Q(r,c){if(1&r&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.xi3(2,1,"filters.results",e.VKq(4,$,t.nbTemporaryFiltersTreks))," ")}}function L(r,c){if(1&r){const t=e.EpF();e.TgZ(0,"ion-footer")(1,"ion-button",12),e.NdJ("click",function(){return e.CHM(t),e.oxw().applyFilters()}),e._UZ(2,"ion-icon",13),e.YNc(3,V,2,0,"span",14),e.YNc(4,U,2,0,"span",15),e.YNc(5,Q,3,6,"span",6),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Q6J("disabled",0===t.nbTemporaryFiltersTreks),e.xp6(2),e.Q6J("ngIf",0===t.nbTemporaryFiltersTreks),e.xp6(1),e.Q6J("ngIf",1===t.nbTemporaryFiltersTreks),e.xp6(1),e.Q6J("ngIf",t.nbTemporaryFiltersTreks>1)}}let q=(()=>{class r{constructor(t,n,o,h){this.modalCtrl=t,this.settings=n,this.onlineTreks=o,this.offlineTreks=h,this.temporaryFilters$=new i.X([]),this.nbTemporaryFiltersTreks=0}ngOnInit(){return(0,T.mG)(this,void 0,void 0,function*(){const t=this.isOnline?this.onlineTreks.treks$:this.offlineTreks.treks$;this.commonSrc=this.isOnline?this.onlineTreks.getCommonImgSrc():yield this.offlineTreks.getCommonImgSrc(),this.filtersSubscription=this.settings.filters$.subscribe(n=>{this.filters=n||[],this.temporaryFilters$.next(n||[])}),this.nbTemporaryFiltersTreksSubscription=(0,C.a)([t,this.temporaryFilters$]).subscribe(([n,o])=>{this.nbTemporaryFiltersTreks=n?m.Z.filter(n,o).length:0})})}handleFiltersState(t,n,o){const h=[...this.temporaryFilters$.getValue()];h.find(I=>I.id===n.id).values.find(I=>I.id===o.id).checked=t,this.temporaryFilters$.next(h)}handleSelect(t){const n=[...this.temporaryFilters$.getValue()];let o=n.findIndex(h=>h.id===t.filter.id);-1!==o&&(n[o]=t.filter,this.temporaryFilters$.next(n))}applyFilters(){this.settings.saveFiltersState(this.temporaryFilters$.getValue()),this.modalCtrl.dismiss(!0)}eraseFilters(){const t=[...this.temporaryFilters$.getValue()];t.forEach(n=>{n.values.forEach(o=>o.checked=!1)}),this.temporaryFilters$.next(t)}close(){this.modalCtrl.dismiss()}ngOnDestroy(){this.filtersSubscription&&this.filtersSubscription.unsubscribe(),this.nbTemporaryFiltersTreksSubscription&&this.nbTemporaryFiltersTreksSubscription.unsubscribe()}trackByFilterId(t,n){return n?n.id:null}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(l.IN),e.Y36(v.g),e.Y36(S.a),e.Y36(F.U))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-filters"]],inputs:{isOnline:"isOnline"},decls:16,vars:10,consts:[["color","primary"],["slot","start"],[3,"click"],["size","large","slot","start","name","close"],["slot","end"],["color","primary","fill","solid",1,"none-transform",3,"click"],[4,"ngIf"],["filtersView",""],["lines","none"],["lines","inset","class","ion-margin-bottom",4,"ngFor","ngForOf"],["lines","inset",1,"ion-margin-bottom"],[1,"full-width",3,"commonSrc","filter","valueChange","selectChange"],["expand","full",3,"disabled","click"],["color","white","slot","start","name","funnel"],["class","min-font","translate","",4,"ngIf"],["translate","",4,"ngIf"],["translate","",1,"min-font"],["translate",""]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),e.NdJ("click",function(){return n.close()}),e._UZ(4,"ion-icon",3),e.qZA()(),e.TgZ(5,"ion-title"),e._uU(6),e.ALo(7,"uppercase"),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"ion-buttons",4)(10,"ion-button",5),e.NdJ("click",function(){return n.eraseFilters()}),e._uU(11),e.ALo(12,"translate"),e.qZA()()()(),e.TgZ(13,"ion-content"),e.YNc(14,M,5,3,"ng-container",6),e.qZA(),e.YNc(15,L,6,4,"ion-footer",6)),2&t&&(e.xp6(6),e.Oqu(e.lcZ(7,4,e.lcZ(8,6,"filters.title"))),e.xp6(5),e.hij(" ",e.lcZ(12,8,"filters.erase")," "),e.xp6(3),e.Q6J("ngIf",n.filters),e.xp6(1),e.Q6J("ngIf",n.filters&&0!==n.filters.length&&null!==n.nbTemporaryFiltersTreks))},directives:[l.Gu,l.sr,l.Sm,l.YG,l.gu,l.wd,l.W2,g.O5,l.q_,g.sg,l.Ie,w,l.fr,_.Pi],pipes:[g.gd,_.X$,g.Ov],styles:[".full-width[_ngcontent-%COMP%]{width:100%}@media screen and (max-width: 540px){.min-font[_ngcontent-%COMP%]{font-size:10px}}"]}),r})()},24:(N,k,p)=>{p.d(k,{g:()=>b});var T=p(7489),i=p(7587);let C=(()=>{class a{search(s,u){return s?u?(u=(0,T.deburr)(u.toLowerCase()),s.filter(f=>(0,T.deburr)(f.properties.name.toLowerCase()).includes(u)).sort(function(f,d){return f.properties.name.localeCompare(d.properties.name)})):s.sort(function(f,d){return f.properties.name.localeCompare(d.properties.name)}):[]}}return a.\u0275fac=function(s){return new(s||a)},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var m=p(786),e=p(5407),l=p(8317),v=p(9808),S=p(7232);function F(a,_){if(1&a){const s=i.EpF();i.TgZ(0,"ion-item",9),i.NdJ("click",function(){const d=i.CHM(s).$implicit;return i.oxw(2).navigateToTrek(d.properties.id)}),i.TgZ(1,"ion-label"),i._uU(2),i.qZA(),i._UZ(3,"ion-icon",10),i.qZA()}if(2&a){const s=_.$implicit;i.xp6(2),i.Oqu(s.properties.name)}}function g(a,_){if(1&a&&(i.TgZ(0,"ion-list"),i.YNc(1,F,4,1,"ion-item",8),i.ALo(2,"slice"),i.qZA()),2&a){const s=i.oxw();i.xp6(1),i.Q6J("ngForOf",i.Dn7(2,1,s.filteredTreks,0,s.currentMaxTreks))}}function y(a,_){1&a&&(i.TgZ(0,"ion-col"),i._uU(1),i.ALo(2,"translate"),i.qZA()),2&a&&(i.xp6(1),i.hij(" ",i.lcZ(2,1,"search.noResult")," "))}function Z(a,_){if(1&a&&(i.TgZ(0,"ion-grid",11)(1,"ion-row"),i.YNc(2,y,3,3,"ion-col",12),i.qZA()()),2&a){const s=i.oxw();i.xp6(2),i.Q6J("ngIf",s.currentSearchValue)}}let b=(()=>{class a{constructor(s,u,f,d,x){this.modalCtrl=s,this.onlineTreks=u,this.offlineTreks=f,this.searchTreks=d,this.navParams=x,this.filteredTreks=[],this.treks=null,this.treksByStep=30,this.currentMaxTreks=30}ngOnInit(){const u=this.navParams.get("isOnline")?this.onlineTreks:this.offlineTreks;this.treksSubscription=u.treks$.subscribe(f=>{this.treks=f,this.treks&&(this.filteredTreks=this.searchTreks.search(this.treks.features,""))})}ngOnDestroy(){this.treksSubscription&&this.treksSubscription.unsubscribe()}close(){this.modalCtrl.dismiss()}search(s){this.currentSearchValue=s.detail.value,this.filteredTreks=this.treks?this.searchTreks.search(this.treks.features,s.detail.value):[]}navigateToTrek(s){this.modalCtrl.dismiss(s)}expandTreks(s){this.currentMaxTreks<this.filteredTreks.length&&(this.currentMaxTreks+this.treksByStep>this.filteredTreks.length?this.currentMaxTreks=this.filteredTreks.length:this.currentMaxTreks+=this.treksByStep),s.target.complete()}}return a.\u0275fac=function(s){return new(s||a)(i.Y36(m.IN),i.Y36(e.a),i.Y36(l.U),i.Y36(C),i.Y36(m.X1))},a.\u0275cmp=i.Xpm({type:a,selectors:[["app-search"]],features:[i._Bn([C])],decls:19,vars:11,consts:[["color","primary"],["slot","start"],[3,"click"],["size","large","slot","start","name","close"],[3,"placeholder","ionChange"],[4,"ngIf","ngIfElse"],["userMsg",""],["threshold","100px",3,"disabled","ionInfinite"],["class","ion-activatable",3,"click",4,"ngFor","ngForOf"],[1,"ion-activatable",3,"click"],["name","arrow-forward-outline","slot","end"],["fixed","",1,"flex-container"],[4,"ngIf"]],template:function(s,u){if(1&s&&(i.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),i.NdJ("click",function(){return u.close()}),i._UZ(4,"ion-icon",3),i.qZA()(),i.TgZ(5,"ion-title"),i._uU(6),i.ALo(7,"uppercase"),i.ALo(8,"translate"),i.qZA()(),i.TgZ(9,"ion-toolbar",0)(10,"ion-searchbar",4),i.NdJ("ionChange",function(d){return u.search(d)}),i.ALo(11,"translate"),i.qZA()()(),i.TgZ(12,"ion-content"),i.ynx(13),i.YNc(14,g,3,5,"ion-list",5),i.YNc(15,Z,3,1,"ng-template",null,6,i.W1O),i.TgZ(17,"ion-infinite-scroll",7),i.NdJ("ionInfinite",function(d){return u.expandTreks(d)}),i._UZ(18,"ion-infinite-scroll-content"),i.qZA(),i.BQk(),i.qZA()),2&s){const f=i.MAs(16);i.xp6(6),i.Oqu(i.lcZ(7,5,i.lcZ(8,7,"search.title"))),i.xp6(4),i.s9C("placeholder",i.lcZ(11,9,"search.placeholder")),i.xp6(4),i.Q6J("ngIf",u.filteredTreks&&u.filteredTreks.length>0)("ngIfElse",f),i.xp6(3),i.Q6J("disabled",!u.filteredTreks||u.currentMaxTreks===u.filteredTreks.length||u.filteredTreks.length<u.treksByStep)}},directives:[m.Gu,m.sr,m.Sm,m.YG,m.gu,m.wd,m.VI,m.j9,m.W2,v.O5,m.q_,v.sg,m.Ie,m.Q$,m.jY,m.Nd,m.wI,m.ju,m.MB],pipes:[v.gd,S.X$,v.OU],styles:[""]}),a})()}}]);