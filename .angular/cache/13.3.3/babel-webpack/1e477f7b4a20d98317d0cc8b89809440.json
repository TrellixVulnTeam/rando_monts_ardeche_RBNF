{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@app/services/offline-treks/offline-treks.service\";\nimport * as i2 from \"@app/services/online-treks/online-treks.service\";\nimport * as i3 from \"@app/services/settings/settings.service\";\n\nfunction TrekCardComponent_ion_card_0_ion_img_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-img\", 10);\n    i0.ɵɵlistener(\"ionError\", function TrekCardComponent_ion_card_0_ion_img_3_Template_ion_img_ionError_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return ctx_r8.onImgSrcError();\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"src\", ctx_r1.imgSrc);\n  }\n}\n\nfunction TrekCardComponent_ion_card_0_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.hydratedTrek.properties.departure, \" \");\n  }\n}\n\nfunction TrekCardComponent_ion_card_0_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.hydratedTrek.properties.departure_city == null ? null : ctx_r3.hydratedTrek.properties.departure_city.name, \" \");\n  }\n}\n\nfunction TrekCardComponent_ion_card_0_ion_img_18_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-img\", 11);\n    i0.ɵɵlistener(\"ionError\", function TrekCardComponent_ion_card_0_ion_img_18_Template_ion_img_ionError_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.onImgPracticeSrcError();\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵstyleProp(\"background-color\", ctx_r4.hydratedTrek.properties.practice.color);\n    i0.ɵɵproperty(\"src\", ctx_r4.imgPracticeSrc);\n  }\n}\n\nfunction TrekCardComponent_ion_card_0_div_21_span_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r12 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(2, 1, 60 * (ctx_r12.hydratedTrek.properties.duration % 1), \"1.0-0\"), \"min\");\n  }\n}\n\nfunction TrekCardComponent_ion_card_0_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵpipe(3, \"lowerRound\");\n    i0.ɵɵtemplate(4, TrekCardComponent_ion_card_0_div_21_span_4_Template, 3, 4, \"span\", 12);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 2, i0.ɵɵpipeBind1(3, 5, ctx_r5.hydratedTrek.properties.duration), \"1.0-0\"), \"h\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r5.hydratedTrek.properties.duration % 1 > 0);\n  }\n}\n\nfunction TrekCardComponent_ion_card_0_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, ctx_r6.hydratedTrek.properties.duration / 24, \"1.0-0\"), \"j \");\n  }\n}\n\nfunction TrekCardComponent_ion_card_0_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind3(2, 1, ctx_r7.hydratedTrek.properties.length / 1000, \"1.1-1\", \"fr\"), \" km \");\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"minimize-padding\": a0\n  };\n};\n\nconst _c1 = function (a0) {\n  return {\n    \"minimize-title\": a0\n  };\n};\n\nfunction TrekCardComponent_ion_card_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-card\", 1);\n    i0.ɵɵelement(1, \"ion-ripple-effect\");\n    i0.ɵɵelementStart(2, \"div\");\n    i0.ɵɵtemplate(3, TrekCardComponent_ion_card_0_ion_img_3_Template, 1, 1, \"ion-img\", 2);\n    i0.ɵɵelementStart(4, \"ion-card-header\", 3)(5, \"ion-card-title\", 3);\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"translate\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(8, \"div\")(9, \"ion-card-content\", 3)(10, \"div\")(11, \"div\", 4);\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"translate\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(14, TrekCardComponent_ion_card_0_div_14_Template, 2, 1, \"div\", 5);\n    i0.ɵɵtemplate(15, TrekCardComponent_ion_card_0_div_15_Template, 2, 1, \"div\", 5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 6)(17, \"div\");\n    i0.ɵɵtemplate(18, TrekCardComponent_ion_card_0_ion_img_18_Template, 1, 3, \"ion-img\", 7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"div\", 8);\n    i0.ɵɵtext(20);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(21, TrekCardComponent_ion_card_0_div_21_Template, 5, 7, \"div\", 9);\n    i0.ɵɵtemplate(22, TrekCardComponent_ion_card_0_div_22_Template, 3, 4, \"div\", 9);\n    i0.ɵɵtemplate(23, TrekCardComponent_ion_card_0_div_23_Template, 3, 5, \"div\", 9);\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"routerLink\", ctx_r0.routerLink);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.imgSrc && !ctx_r0.hideImgSrc);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(19, _c0, !ctx_r0.showAllData));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(21, _c1, !ctx_r0.showAllData));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", ctx_r0.isStage ? i0.ɵɵpipeBind1(7, 15, \"trek.details.stage\") + \" \" + ctx_r0.numStage + \" - \" : \"\", \" \", ctx_r0.hydratedTrek.properties == null ? null : ctx_r0.hydratedTrek.properties.name, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(23, _c0, !ctx_r0.showAllData));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(13, 17, \"treks.departure\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.hydratedTrek.properties.departure);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.hydratedTrek.properties.departure && ctx_r0.hydratedTrek.properties.departure_city);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.imgPracticeSrc && !ctx_r0.hideImgPracticeSrc);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.hydratedTrek.properties.difficulty == null ? null : ctx_r0.hydratedTrek.properties.difficulty.name, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.hydratedTrek.properties.duration < 24 && ctx_r0.showAllData);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.hydratedTrek.properties.duration >= 24 && ctx_r0.showAllData);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.showAllData);\n  }\n}\n\nexport let TrekCardComponent = /*#__PURE__*/(() => {\n  class TrekCardComponent {\n    constructor(offlineTreks, onlineTreks, settings) {\n      this.offlineTreks = offlineTreks;\n      this.onlineTreks = onlineTreks;\n      this.settings = settings;\n      this.offline = false;\n      this.isStage = false;\n      this.numStage = 0;\n      this.parentId = undefined;\n      this.firstTryToLoadFromOnline = true;\n      this.hideImgPracticeSrc = false;\n      this.hideImgSrc = false;\n    }\n\n    ngOnInit() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const isAvailableOffline = yield this.offlineTreks.trekIsAvailableOffline(this.trek.properties.id);\n        const trekService = this.offline || isAvailableOffline ? this.offlineTreks : this.onlineTreks;\n        this.hydratedTrek = this.settings.getHydratedTrek(this.trek, yield trekService.getCommonImgSrc());\n\n        if (this.hydratedTrek.properties.practice) {\n          this.imgPracticeSrc = yield this.offlineTreks.getTrekImageSrc({}, {\n            url: this.hydratedTrek.properties.practice.pictogram\n          });\n        }\n\n        if (this.offline || isAvailableOffline) {\n          this.imgSrc = yield this.offlineTreks.getTrekImageSrc(this.trek);\n        } else {\n          this.imgSrc = this.onlineTreks.getTrekImageSrc(this.trek);\n        }\n\n        if (this.isStage) {\n          this.routerLink = `/trek-details${this.offline ? '-offline' : ''}/${this.parentId}/${this.trek.properties.id}`;\n        } else {\n          this.routerLink = `/trek-details${this.offline ? '-offline' : ''}/${this.trek.properties.id}`;\n        }\n      });\n    }\n\n    onImgSrcError() {\n      this.hideImgSrc = true;\n    }\n\n    onImgPracticeSrcError() {\n      if (this.hydratedTrek.properties.practice && this.firstTryToLoadFromOnline) {\n        this.firstTryToLoadFromOnline = false;\n        this.imgPracticeSrc = this.onlineTreks.getTrekImageSrc({}, {\n          url: this.hydratedTrek.properties.practice.pictogram\n        });\n      } else {\n        this.hideImgPracticeSrc = true;\n      }\n    }\n\n  }\n\n  TrekCardComponent.ɵfac = function TrekCardComponent_Factory(t) {\n    return new (t || TrekCardComponent)(i0.ɵɵdirectiveInject(i1.OfflineTreksService), i0.ɵɵdirectiveInject(i2.OnlineTreksService), i0.ɵɵdirectiveInject(i3.SettingsService));\n  };\n\n  TrekCardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TrekCardComponent,\n    selectors: [[\"app-trek-card\"]],\n    inputs: {\n      trek: \"trek\",\n      offline: \"offline\",\n      showAllData: \"showAllData\",\n      isStage: \"isStage\",\n      numStage: \"numStage\",\n      parentId: \"parentId\"\n    },\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"no-outline pointer extand-card ion-activatable\", 3, \"routerLink\", 4, \"ngIf\"], [1, \"no-outline\", \"pointer\", \"extand-card\", \"ion-activatable\", 3, \"routerLink\"], [\"class\", \"min-size-img\", 3, \"src\", \"ionError\", 4, \"ngIf\"], [3, \"ngClass\"], [1, \"ellipsis\"], [\"class\", \"ellipsis\", 4, \"ngIf\"], [1, \"extra-content-card\"], [\"class\", \"picto-practice\", 3, \"background-color\", \"src\", \"ionError\", 4, \"ngIf\"], [1, \"ion-padding-start\"], [\"class\", \"ion-padding-start\", 4, \"ngIf\"], [1, \"min-size-img\", 3, \"src\", \"ionError\"], [1, \"picto-practice\", 3, \"src\", \"ionError\"], [4, \"ngIf\"]],\n    template: function TrekCardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, TrekCardComponent_ion_card_0_Template, 24, 25, \"ion-card\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.hydratedTrek);\n      }\n    },\n    styles: [\".extand-card[_ngcontent-%COMP%]{height:calc(100% - 20px);display:flex;flex-direction:column;justify-content:space-between}.picto-practice[_ngcontent-%COMP%]{max-width:24px;max-height:24px}.extra-content-card[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;flex-wrap:wrap;margin-top:12px}.ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.minimize-title[_ngcontent-%COMP%]{font-size:16px}ion-card-header[_ngcontent-%COMP%]{padding:16px}ion-card-content[_ngcontent-%COMP%]{padding:0 16px 16px}ion-card-header.minimize-padding[_ngcontent-%COMP%]{padding:8px}ion-card-content.minimize-padding[_ngcontent-%COMP%]{padding:0 8px 8px}\"]\n  });\n  return TrekCardComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}