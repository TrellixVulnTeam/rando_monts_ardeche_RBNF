{"ast":null,"code":"import { deburr } from 'lodash';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@app/components/filter-value/filter-value.component\";\nimport * as i4 from \"@ngx-translate/core\";\n\nfunction SelectFilterComponent_ion_toolbar_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-toolbar\", 0)(1, \"ion-searchbar\", 6);\n    i0.ɵɵlistener(\"ionChange\", function SelectFilterComponent_ion_toolbar_4_Template_ion_searchbar_ionChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return ctx_r2.search($event);\n    });\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"placeholder\", i0.ɵɵpipeBind1(2, 1, \"filters.searchPlaceholder\"));\n  }\n}\n\nfunction SelectFilterComponent_app_filter_value_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-filter-value\", 7);\n    i0.ɵɵlistener(\"valueChange\", function SelectFilterComponent_app_filter_value_6_Template_app_filter_value_valueChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.valueChanged($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const value_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"commonSrc\", ctx_r1.commonSrc)(\"value\", value_r4);\n  }\n}\n\nexport let SelectFilterComponent = /*#__PURE__*/(() => {\n  class SelectFilterComponent {\n    constructor(modalController) {\n      this.modalController = modalController;\n      this.currentMaxFilterValues = 20;\n      this.filterValuesByStep = 20;\n    }\n\n    ngOnInit() {\n      this.temporaryFilter = this.filter;\n      this.valuesToDisplay = [...this.filter.values];\n    }\n\n    cancel() {\n      this.modalController.dismiss();\n    }\n\n    select() {\n      this.modalController.dismiss({\n        temporaryFilter: this.temporaryFilter\n      });\n    }\n\n    expandFilterValues(infiniteScroll) {\n      if (this.currentMaxFilterValues < this.valuesToDisplay.length) {\n        if (this.currentMaxFilterValues + this.filterValuesByStep > this.valuesToDisplay.length) {\n          this.currentMaxFilterValues = this.valuesToDisplay.length;\n        } else {\n          this.currentMaxFilterValues += this.filterValuesByStep;\n        }\n      }\n\n      infiniteScroll.target.complete();\n    }\n\n    trackFilterValues(index, element) {\n      return element ? element.id : null;\n    }\n\n    valueChanged(event) {\n      const filterValue = this.temporaryFilter.values.find(value => value.id === event.value.id);\n\n      if (filterValue) {\n        filterValue.checked = event.checked;\n      }\n    }\n\n    search(searchValue) {\n      if (searchValue.detail.value) {\n        this.valuesToDisplay = this.searchValuesInFilter(this.filter, searchValue.detail.value);\n      } else {\n        this.valuesToDisplay = [...this.filter.values];\n      }\n\n      this.currentMaxFilterValues = this.filterValuesByStep;\n    }\n\n    searchValuesInFilter(filter, searchValue) {\n      if (!filter) {\n        return [];\n      }\n\n      if (!!!searchValue) {\n        return filter.values.sort(function (a, b) {\n          return a.name.localeCompare(b.name);\n        });\n      }\n\n      searchValue = searchValue.toLowerCase();\n      return filter.values.filter(value => {\n        return deburr(value.name.toLowerCase()).startsWith(searchValue);\n      }).sort(function (a, b) {\n        return a.name.localeCompare(b.name);\n      });\n    }\n\n  }\n\n  SelectFilterComponent.ɵfac = function SelectFilterComponent_Factory(t) {\n    return new (t || SelectFilterComponent)(i0.ɵɵdirectiveInject(i1.ModalController));\n  };\n\n  SelectFilterComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SelectFilterComponent,\n    selectors: [[\"app-select-filter\"]],\n    inputs: {\n      filter: \"filter\",\n      commonSrc: \"commonSrc\"\n    },\n    decls: 19,\n    vars: 14,\n    consts: [[\"color\", \"primary\"], [\"color\", \"primary\", 4, \"ngIf\"], [3, \"commonSrc\", \"value\", \"valueChange\", 4, \"ngFor\", \"ngForOf\", \"ngForTrackBy\"], [\"threshold\", \"100px\", 3, \"ionInfinite\"], [\"slot\", \"end\"], [\"color\", \"primary\", \"fill\", \"clear\", 3, \"click\"], [3, \"placeholder\", \"ionChange\"], [3, \"commonSrc\", \"value\", \"valueChange\"]],\n    template: function SelectFilterComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\", 0)(2, \"ion-title\");\n        i0.ɵɵtext(3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(4, SelectFilterComponent_ion_toolbar_4_Template, 3, 3, \"ion-toolbar\", 1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"ion-content\");\n        i0.ɵɵtemplate(6, SelectFilterComponent_app_filter_value_6_Template, 1, 2, \"app-filter-value\", 2);\n        i0.ɵɵpipe(7, \"slice\");\n        i0.ɵɵelementStart(8, \"ion-infinite-scroll\", 3);\n        i0.ɵɵlistener(\"ionInfinite\", function SelectFilterComponent_Template_ion_infinite_scroll_ionInfinite_8_listener($event) {\n          return ctx.expandFilterValues($event);\n        });\n        i0.ɵɵelement(9, \"ion-infinite-scroll-content\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(10, \"ion-footer\")(11, \"ion-toolbar\")(12, \"ion-buttons\", 4)(13, \"ion-button\", 5);\n        i0.ɵɵlistener(\"click\", function SelectFilterComponent_Template_ion_button_click_13_listener() {\n          return ctx.cancel();\n        });\n        i0.ɵɵtext(14);\n        i0.ɵɵpipe(15, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"ion-button\", 5);\n        i0.ɵɵlistener(\"click\", function SelectFilterComponent_Template_ion_button_click_16_listener() {\n          return ctx.select();\n        });\n        i0.ɵɵtext(17);\n        i0.ɵɵpipe(18, \"translate\");\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(ctx.filter.values.length + \" \" + ctx.filter.name);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.filter.values.length > ctx.filterValuesByStep);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind3(7, 6, ctx.valuesToDisplay, 0, ctx.currentMaxFilterValues))(\"ngForTrackBy\", ctx.trackFilterValues);\n        i0.ɵɵadvance(8);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(15, 10, \"filters.cancelButton\"), \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(18, 12, \"filters.confirmButton\"), \" \");\n      }\n    },\n    directives: [i1.IonHeader, i1.IonToolbar, i1.IonTitle, i2.NgIf, i1.IonSearchbar, i1.TextValueAccessor, i1.IonContent, i2.NgForOf, i3.FilterValueComponent, i1.IonInfiniteScroll, i1.IonInfiniteScrollContent, i1.IonFooter, i1.IonButtons, i1.IonButton],\n    pipes: [i4.TranslatePipe, i2.SlicePipe],\n    styles: [\"\"]\n  });\n  return SelectFilterComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}